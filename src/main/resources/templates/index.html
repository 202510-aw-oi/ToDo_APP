<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8" />
    <title>ToDo一覧</title>
    <style>
        .page-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 12px;
        }

        .page-header .home-link {
            display: inline-block;
            padding: 4px 8px;
            border: none;
            border-radius: 4px;
            text-decoration: none;
        }

        .page-header .add-link {
            display: inline-flex;
            align-items: center;
        }

        .page-header h1 {
            margin: 0;
            font-size: 1.5rem;
        }

        .search-bar {
            display: flex;
            align-items: center;
            gap: 8px;
            margin: 8px 0 8px;
        }

        .search-bar input[type="text"] {
            width: 240px;
            padding: 4px 8px;
        }

        .clear-link {
            text-decoration: none;
            padding: 4px 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }

        .search-meta {
            margin: 0 0 12px;
            color: #555;
        }

        .todo-title {
            width: 8em;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .todo-author {
            width: 5em;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            text-align: center;
        }

        .todo-type {
            width: 5em;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            text-align: center;
        }

        .todo-type select {
            width: 100%;
            text-align: center;
            text-align-last: center;
        }

        .todo-priority {
            width: 5em;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            text-align: center;
        }

        .todo-created-at {
            width: 8em;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            text-align: center;
        }

        .todo-due-date {
            width: 8em;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            text-align: center;
        }

        .todo-detail {
            width: 20em;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .todo-edit {
            width: 3em;
            text-align: center;
        }

        .todo-delete {
            width: 3em;
            text-align: center;
        }
    </style>
</head>

<body>
    <header class="page-header">
        <a class="home-link" th:href="@{/}" aria-label="Home" title="Home">
            <svg width="40" height="40" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                <path d="M7 3h8l4 4v14H7z" fill="none" stroke="currentColor" stroke-width="1.5" />
                <path d="M15 3v4h4" fill="none" stroke="currentColor" stroke-width="1.5" />
                <path d="M9 11h8M9 14h8M9 17h6" fill="none" stroke="currentColor" stroke-width="1.5" />
            </svg>
        </a>
        <a class="add-link" th:href="@{/edit}" aria-label="新規登録" title="新規登録">
            <svg width="28" height="28" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                <circle cx="12" cy="12" r="9" fill="none" stroke="currentColor" stroke-width="1.5" />
                <path d="M12 8v8M8 12h8" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" />
            </svg>
        </a>
        <h1>ToDo一覧</h1>
    </header>

    <form class="search-bar" th:action="@{/}" method="get">
        <label>
            種類:
            <select name="type">
                <option value="" th:selected="${type == ''}">未選択</option>
                <option value="Work" th:selected="${type == 'Work'}">Work</option>
                <option value="Private" th:selected="${type == 'Private'}">Private</option>
                <option value="Fitness" th:selected="${type == 'Fitness'}">Fitness</option>
                <option value="Self-Dev" th:selected="${type == 'Self-Dev'}">Self-Dev</option>
            </select>
        </label>
        <label>
            優先度:
            <select th:field="*{priority}">
                <option value="">未選択</option>
                <option value="1">HIGH</option>
                <option value="2">MEDIUM</option>
                <option value="3">LOW</option>
            </select>
        </label>
        <button type="submit">検索</button>
        <a class="clear-link" th:href="@{/}" th:if="${isSearching}">クリア</a>
    </form>
    <div class="search-meta">検索結果: <span th:text="${count}">0</span>件</div>

    <table th:if="${!#lists.isEmpty(todos)}" border="1">
        <thead>
            <tr>
                <th>☑</th>
                <th>No</th>
                <th>タイトル</th>
                <th>登録者</th>
                <th>作成日</th>
                <th>種類</th>
                <th>優先度</th>
                <th>期限日</th>
                <th>詳細</th>
                <th class="todo-edit">編集</th>
                <th class="todo-delete">削除</th>
            </tr>
        </thead>
        <tbody>
            <tr th:each="todo, stat : ${todos}">
                <td>
                    <input type="checkbox" th:name="${'todoCheck' + stat.count}" th:value="${todo.id}" />
                </td>
                <td th:text="${stat.count}">1</td>
                <td class="todo-title" th:text="${todo.title}" th:title="${todo.title}">title</td>
                <td class="todo-author" th:text="${todo.author}" th:title="${todo.author}">author</td>
                <td class="todo-created-at" th:text="${#temporals.format(todo.createdAt, 'yyyy/MM/dd')}">2026/02/02</td>
                <td class="todo-type" th:text="${todo.type}" th:title="${todo.type}">type</td>
                <td class="todo-priority"
                    th:text="${todo.priority == 1 ? 'HIGH' : (todo.priority == 2 ? 'MEDIUM' : 'LOW')}">MEDIUM</td>
                <td class="todo-due-date" th:text="${#temporals.format(todo.dueDate, 'yyyy/MM/dd')}">2026/02/02</td>
                <td class="todo-detail" th:text="${todo.detail}" th:title="${todo.detail}">detail</td>
                <td class="todo-edit">
                    <a th:href="@{/edit/{id}(id=${todo.id})}">編集</a>
                </td>
                <td class="todo-delete">
                    <form th:action="@{/delete/{id}(id=${todo.id})}" method="post"
                        onsubmit="return confirm('削除してよろしいですか？');">
                        <button type="submit">削除</button>
                    </form>
                </td>
            </tr>
        </tbody>
    </table>
</body>

</html>